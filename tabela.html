<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabela</title>
</head>
<body>
    <table id="tabela"></table>
    <script>
        function generateTableFollowUps(tiposAtendimento, datas) {
            const semana = [
                "Domingo",
                "Segunda",
                "Terça",
                "Quarta",
                "Quinta",
                "Sexta",
                "Sábado"
            ]

            const table = document.createElement("table")
            const thead = document.createElement("thead")
            const tbody = document.createElement("tbody")

            table.appendChild(thead)
            table.appendChild(tbody)

            const trDatasTHead = document.createElement('tr')
            const trDiasSemanaTHead = document.createElement('tr')
            const trHorariosTHead = document.createElement('tr')

            const th = document.createElement("th")
            th.style.background = "rgb(0 86 137)"
            th.style.color = "#FFF"
            th.rowSpan = 3
            th.innerHTML = "Atendimento / Data"
            trDatasTHead.appendChild(th)

            thead.appendChild(trDatasTHead)
            thead.appendChild(trDiasSemanaTHead)
            thead.appendChild(trHorariosTHead)                
            
            for (const tipo of tiposAtendimento) {
                const tr = document.createElement("tr")
                const th = document.createElement("th")
                th.innerHTML = tipo
                tr.classList.add("nCollumn")
                tr.appendChild(th)
                for(const data of datas) {
                    //THead
                    if (tipo === tiposAtendimento[0]) {
                        const thData = document.createElement("th")
                        thData.colSpan = 9
                        thData.innerHTML = data.toLocaleDateString()
                        thData.dataset['date'] = data.toLocaleDateString()
                        thData.classList.add("dRow")
                        trDatasTHead.appendChild(thData)

                        const thSemana = document.createElement("th")
                        thSemana.colSpan = 9
                        thSemana.innerHTML = semana[data.getDay()]
                        thSemana.dataset['date'] = data.toLocaleDateString()
                        thSemana.classList.add("dRow")
                        trDiasSemanaTHead.appendChild(thSemana)

                        const thMorning = document.createElement("th")
                        thMorning.innerHTML = "Manhã"
                        thMorning.colSpan = 3
                        thMorning.classList.add("dRow")
                        trHorariosTHead.appendChild(thMorning)

                        const thAfternoon = document.createElement("th")
                        thAfternoon.innerHTML = "Tarde"
                        thAfternoon.colSpan = 3
                        thAfternoon.classList.add("dRow")
                        trHorariosTHead.appendChild(thAfternoon)

                        const thUndefined = document.createElement("th")
                        thUndefined.innerHTML = "Indefinido"
                        thUndefined.colSpan = 3
                        thUndefined.classList.add("dRow")
                        trHorariosTHead.appendChild(thUndefined)
                    }
                    
                    //TBody
                    for (let index = 1; index <= 3; index++) {
                        const tdAgendamentos = document.createElement("td")
                        tdAgendamentos.dataset['originalTitle'] = "Agendamentos"
                        tdAgendamentos.dataset['toggle'] = "tooltip"
                        tdAgendamentos.dataset['placement'] = "Top"
                        tdAgendamentos.dataset['categoria'] = "Agendamentos"
                        tdAgendamentos.dataset['nome'] = tipo
                        tdAgendamentos.dataset['date'] = data.toLocaleDateString()
                        tdAgendamentos.style.background = "#A5D5EF"
                        tdAgendamentos.innerHTML = '-'
                        
                        const tdPrioridades = document.createElement("td")
                        tdPrioridades.dataset['originalTitle'] = "Prioridades"
                        tdPrioridades.dataset['toggle'] = "tooltip"
                        tdPrioridades.dataset['placement'] = "Top"
                        tdPrioridades.dataset['categoria'] = "Prioridades"
                        tdPrioridades.dataset['nome'] = tipo
                        tdPrioridades.dataset['date'] = data.toLocaleDateString()
                        tdPrioridades.style.background = "#CCC"
                        tdPrioridades.innerHTML = "-"
                        
                        const tdTotal = document.createElement("td")
                        tdPrioridades.dataset['originalTitle'] = "Total"
                        tdTotal.dataset['toggle'] = "tooltip"
                        tdTotal.dataset['placement'] = "Top"
                        tdTotal.dataset['categoria'] = "Total"
                        tdTotal.dataset['nome'] = tipo
                        tdTotal.dataset['date'] = data.toLocaleDateString()
                        tdTotal.style.background = "#ADADAD"
                        tdTotal.innerHTML = "-"
    
                        tr.appendChild(tdAgendamentos)
                        tr.appendChild(tdPrioridades)
                        tr.appendChild(tdTotal)
                    }
                }
                tbody.append(tr)
            }

            return table.innerHTML
        }
        const horarios = {
            morning: "Manhã",
            afternoon: "Tarde",
            undefined: "Indefinido"
            },
            modosAgendamento = {
                total: "Agendamentos",
                priority: "Prioridades",
                scheduling: "Total"
            }
        const { datas, dias } = {
            "datas": [
                new Date("2025-02-24T03:00:00.000Z"),
                new Date("2025-02-25T03:00:00.000Z"),
                new Date("2025-02-26T03:00:00.000Z"),
                new Date("2025-02-27T03:00:00.000Z"),
                new Date("2025-02-28T03:00:00.000Z"),
                new Date("2025-03-01T03:00:00.000Z"),
                new Date("2025-03-02T03:00:00.000Z"),
                new Date("2025-03-03T03:00:00.000Z"),
                new Date("2025-03-04T03:00:00.000Z"),
                new Date("2025-03-05T03:00:00.000Z"),
                new Date("2025-03-06T03:00:00.000Z"),
                new Date("2025-03-07T03:00:00.000Z")
            ],
            "dias": [
                1,
                2,
                3,
                4,
                5,
                6,
                0,
                1,
                2,
                3,
                4,
                5
            ]
        }
        const tiposAtendimento = [
            "AASM - DF",
            "ÁGUA QUENTE -DF",
            "ATENDIMENTO ÁGUAS LINDAS",
            "ATENDIMENTO CÍVEL",
            "ATENDIMENTO DR. DIEGO",
            "ATENDIMENTO DR. FABIO",
            "ATENDIMENTO DR. MARCUS",
            "ATENDIMENTO DRA. SARA",
            "ATENDIMENTO ESTÂNCIA",
            "ATENDIMENTO PLANTONISTA (TESTE)",
            "ATENDIMENTO SANTA MARIA (FILIAL AJU)",
            "ATENDIMENTO TAGUATINGA",
            "ATENDIMENTO TRABALHISTA",
            "NOVO GAMA - DF",
            "ORIENTAÇÃO DE AUDIÊNCIA",
            "PORTO RICO - DF",
            "PREVIDENCIÁRIO - VIRTUAL",
            "PREVIDENCIÁRIO QUINTA-FEIRA DE TARDE",
            "PREVIDENCIÁRIO SEGUNDA E QUARTA-FEIRA DE MANHÃ",
            "VALPARAÍSO - DF"
        ]
        
        const table = document.getElementById("tabela")

        tabela.innerHTML = generateTableFollowUps(tiposAtendimento, datas)
    </script>
</body>
</html>